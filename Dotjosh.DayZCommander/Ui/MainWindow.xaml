<Window x:Class="Dotjosh.DayZCommander.Ui.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:Ui="clr-namespace:Dotjosh.DayZCommander.Ui" 
		Title="MainWindow" 
		Height="650" 
		Width="970"
		AllowsTransparency="True" 
		WindowStyle="None"
		WindowStartupLocation="CenterScreen"
		ResizeMode="CanResizeWithGrip"
		MouseLeftButtonDown="MainWindow_OnMouseLeftButtonDown"
		MouseDoubleClick="MainWindow_OnMouseDoubleClick"
		>
	<Border Background="#222222"
			BorderBrush="#BBBBBB"
			x:Name="VisualRoot"
			BorderThickness="1">
		<Grid>
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto" />
				<RowDefinition Height="Auto" />
				<RowDefinition Height="Auto" />
				<RowDefinition />
			</Grid.RowDefinitions>
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="180"/>
				<ColumnDefinition/>
			</Grid.ColumnDefinitions>

				<Rectangle Fill="#444444"
					   Grid.Row="1"
						    IsHitTestVisible="True"
					   Grid.RowSpan="4"
					   Grid.ColumnSpan="2"/>

			<Grid Grid.ColumnSpan="2">
				<Grid.ColumnDefinitions>
					<ColumnDefinition/>
					<ColumnDefinition Width="Auto"/>
				</Grid.ColumnDefinitions>

				<StackPanel>
					<StackPanel Orientation="Horizontal"
					           Margin="30 4 0 -8">
						<TextBlock Text="{Binding CurrentVersion, FallbackValue=Unknown}"
					           FontSize="10"
					           Width="245"
					           TextAlignment="Right"
					           HorizontalAlignment="Left"
					           Foreground="#777"/>
						<TextBlock Text="A new version will be applied the next time you run this program."
								   Margin="10 0 0 0"
								   FontSize="10"
								   Visibility="{Binding RestartToApplyUpdate, Converter={StaticResource BooleanToVisibilityHiddenConverter}}"
								   HorizontalAlignment="Right"
								   Foreground="LightGreen"/>
					</StackPanel>
					<TextBlock Text="DayZ Commander"
						   Foreground="#EEEEEE"
						   FontSize="28"
						Grid.Column="0"
						   HorizontalAlignment="Left"
							IsHitTestVisible="False"
						   Margin="30 -6 0 7"/>
				</StackPanel>
				<StackPanel Grid.Column="1" 
						HorizontalAlignment="Right">
					<Button Tag="X" 
						Margin="0 8 10 0"
						Foreground="#EEE"
						FontSize="14"
						FontFamily="Verdana"
						Template="{StaticResource MetroTextButton}" Click="CloseButton_Click" />
				</StackPanel>
			</Grid>

			<Grid Grid.Row="1" 
						Grid.RowSpan="3" 
						Margin="30 8 0 0"
						Grid.Column="0">

				<ContentControl DataContext="{Binding LeftPaneViewModel.CurrentScreen}"
								HorizontalAlignment="Stretch"
								VerticalAlignment="Stretch">
					<ContentControl.Resources>
						<DataTemplate DataType="{x:Type Ui:FriendsListViewModel}">
							<Ui:FriendsList/>
						</DataTemplate>

						<DataTemplate DataType="{x:Type Ui:FiltersViewModel}">
							<Ui:Filters/>
						</DataTemplate>
					</ContentControl.Resources>
				</ContentControl>
				
			</StackPanel>

			<StackPanel
						Grid.Column="1"
					   Margin="36 8 20 0"
					   Grid.Row="1">
				<Grid>
					<StackPanel Orientation="Horizontal">

						<TextBlock Text="servers " Foreground="#EEE" Margin="0 0 0 0" FontSize="22"/>
						<TextBlock Text="(" FontSize="15" Foreground="#EEE" Margin="0 7 0 0"/>
						<TextBlock Text="{Binding Servers.Count, StringFormat={}{0}/, FallbackValue=0}" 
							   Visibility="{Binding HasFilteredServers, Converter={StaticResource BooleanToVisibilityCollapsedConverter}}"
							   Foreground="#AAA"
							   Margin="0 7 0 0"
							   FontSize="15"/>
						<TextBlock Text="{Binding TotalServerCount, StringFormat={}{0}), FallbackValue=0}"
						   FontSize="15"
							   Margin="0 7 0 0"
							  Foreground="#EEE"/>

					</StackPanel>

					<Button Template="{StaticResource MetroButton}"
							Click="RefreshAll_Click"
							HorizontalAlignment="Right"
							Visibility="{Binding UnprocessedServersCount, Converter={StaticResource ZeroToVisibilityConverter}}"
							Margin="0 6 23 0">
						<Button.Content>
							<StackPanel Orientation="Horizontal">
								<Image Source="..\Assets\Images\refresh.png" 
								   Height="24"
								   Width="24"/>
								<TextBlock Text="refresh"
										   VerticalAlignment="Center"
										   Foreground="#FFF"/>
							</StackPanel>
						</Button.Content>
					</Button>

				</Grid>
				<ProgressBar 
							 HorizontalAlignment="Stretch" 
							 BorderThickness="0" 
							 Height="7" 
							 Background="Transparent" 
							 Visibility="{Binding UnprocessedServersCount, Converter={StaticResource NonZeroToVisibilityHiddenConverter}}"
							 Maximum="{Binding TotalServerCount, FallbackValue=0}" 
							 Value="{Binding ProcessedServersCount, FallbackValue=0}" />
			</StackPanel>

				<DataGrid ItemsSource="{Binding Servers}"
						 Margin="31 3 20 20"
				  Grid.Column="1"
				  Grid.Row="3"
					  VerticalScrollBarVisibility="Visible"
						HorizontalScrollBarVisibility="Disabled"
					  Background="Transparent"
					 HeadersVisibility="Column"
					  Foreground="#DDD"
					  RowBackground="Transparent"
					  BorderThickness="0"
					  SelectedItem="{Binding SelectedServer, Mode=TwoWay}"
					ColumnHeaderStyle="{StaticResource MetroDataGridHeader}"						  
					  AutoGenerateColumns="False">
				<DataGrid.RowStyle>
					<Style TargetType="{x:Type DataGridRow}">
						<EventSetter Event="MouseDoubleClick" Handler="RowDoubleClick"/>
						<EventSetter Event="PreviewMouseLeftButtonDown" Handler="RowLeftButtonDown"/>
					</Style>
				</DataGrid.RowStyle>
				<DataGrid.Resources>
						<Style TargetType="{x:Type DataGridCell}">
							<Setter Property="Template">
								<Setter.Value>
									<ControlTemplate TargetType="{x:Type DataGridCell}">
										<Border Padding="3 2 8 2">
											<ContentPresenter />
										</Border>
									</ControlTemplate>
								</Setter.Value>
							</Setter>
						</Style>
					</DataGrid.Resources>
					<DataGrid.Columns>
						<DataGridTextColumn Binding="{Binding Name, Mode=OneWay}" 
											HeaderStyle="{StaticResource MetroDataGridHeader}"
											Header="NAME"	
											Width="*" >
						</DataGridTextColumn>
						<DataGridTemplateColumn 
											HeaderStyle="{StaticResource MetroDataGridHeaderCenter}"
											Header="SETTINGS"	
											SortMemberPath="Difficulty"
											Width="80" >
							<DataGridTemplateColumn.CellTemplate>
								<DataTemplate>
									<StackPanel Orientation="Horizontal" 
												VerticalAlignment="Center"
												Margin="5 0 0 0"
												HorizontalAlignment="Center">
										<TextBlock Text="A" ToolTipService.ToolTip="Armor" Margin="1 0 1 0" Foreground="{Binding Info.Armor.Enabled, Converter={StaticResource EnabledSettingToForegroundConverter}}" />
										<TextBlock Text="3" ToolTipService.ToolTip="Third Person" Margin="1 0 1 0" Foreground="{Binding Info.ThirdPerson.Enabled, Converter={StaticResource EnabledSettingToForegroundConverter}}" />
										<TextBlock Text="T" ToolTipService.ToolTip="Tracers" Margin="1 0 1 0" Foreground="{Binding Info.Tracers.Enabled, Converter={StaticResource EnabledSettingToForegroundConverter}}" />
										<TextBlock Text="N" ToolTipService.ToolTip="Nameplates" Margin="1 0 1 0" Foreground="{Binding Info.Nameplates.Enabled, Converter={StaticResource EnabledSettingToForegroundConverter}}" />
										<TextBlock Text="C" ToolTipService.ToolTip="Crosshairs" Margin="1 0 1 0" Foreground="{Binding Info.Crosshairs.Enabled, Converter={StaticResource EnabledSettingToForegroundConverter}}" />
										<TextBlock Text="D" ToolTipService.ToolTip="Death Messages" Margin="1 0 1 0" Foreground="{Binding Info.DeathMessages.Enabled, Converter={StaticResource EnabledSettingToForegroundConverter}}" />
										<TextBlock Text="S" ToolTipService.ToolTip="Scores" Margin="1 0 1 0" Foreground="{Binding Info.Scores.Enabled, Converter={StaticResource EnabledSettingToForegroundConverter}}" />
									</StackPanel>
								</DataTemplate>
							</DataGridTemplateColumn.CellTemplate>							
						</DataGridTemplateColumn>
						<DataGridTemplateColumn Width="80" 
												Header="DAY/NIGHT" 
												SortMemberPath="ServerTime" 
												HeaderStyle="{StaticResource MetroDataGridHeaderRight}">
							<DataGridTemplateColumn.CellTemplate>
								<DataTemplate>
									<TextBlock Text="{Binding ServerTime, StringFormat={}{0:h:mm tt}}"
										   TextAlignment="Right"
										   HorizontalAlignment="Right"
										   VerticalAlignment="Center"
										Foreground="{Binding ServerTime, Converter={StaticResource TimeToColorConverter}}"/>
								</DataTemplate>
							</DataGridTemplateColumn.CellTemplate>
						</DataGridTemplateColumn>
						<DataGridTemplateColumn Width="66" Header="PLAYERS" SortMemberPath="CurrentPlayers" HeaderStyle="{StaticResource MetroDataGridHeaderRight}">
							<DataGridTemplateColumn.CellTemplate>
								<DataTemplate>
									<StackPanel Orientation="Horizontal" 
											VerticalAlignment="Center"
											HorizontalAlignment="Right">
										<TextBlock Text="{Binding CurrentPlayers}" Foreground="{Binding Converter={StaticResource ServerFullnessToColorConverter}}"/>
										<TextBlock Text="/"/>
										<TextBlock Text="{Binding MaxPlayers}" Foreground="{Binding Converter={StaticResource ServerFullnessToColorConverter}}"/>
									<StackPanel.ToolTip>
										<ToolTip>
											<ItemsControl ItemsSource="{Binding Players}">
												<ItemsControl.Template>
													<ControlTemplate>
														<UniformGrid Columns="4"
																   IsItemsHost="True"/>
													</ControlTemplate>
												</ItemsControl.Template>
												<ItemsControl.ItemTemplate>
													<DataTemplate>
														<TextBlock Text="{Binding Name}" 
																   Foreground="#333"
																   Margin="0 0 6 0"/>
													</DataTemplate>
												</ItemsControl.ItemTemplate>
											</ItemsControl>
										</ToolTip>
									</StackPanel.ToolTip>
								</StackPanel>
								</DataTemplate>
							</DataGridTemplateColumn.CellTemplate>
						</DataGridTemplateColumn>
						<DataGridTemplateColumn Width="65" Header="PING" SortMemberPath="Ping" HeaderStyle="{StaticResource MetroDataGridHeaderRight}">
							<DataGridTemplateColumn.CellTemplate>
								<DataTemplate>
									<Grid>
										<ProgressBar Value="{Binding Ping}" 
												 Maximum="400" 
												 Width="55" 
												 Height="20" 
													 HorizontalAlignment="Right"
												 IsIndeterminate="False" 
												 Foreground="{Binding Ping, Converter={StaticResource PingToForegroundConverter}}" 
												 Background="#AAA"/>
									<TextBlock Text="{Binding Ping, StringFormat={}{0}ms}" 
											   Foreground="#000"  
											   FontSize="12" 
											   Padding="0 4 4 0"
											   Width="50" 
											   HorizontalAlignment="Right"
											   Height="20" 
											   VerticalAlignment="Center" 
											   TextAlignment="Right">
																		
									</TextBlock>
								</Grid>
								</DataTemplate>
							</DataGridTemplateColumn.CellTemplate>
						</DataGridTemplateColumn>
					</DataGrid.Columns>
				</DataGrid>
				
		
		</Grid>

	</Border>
</Window>
