<Window x:Class="Dotjosh.DayZCommander.Ui.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:Ui="clr-namespace:Dotjosh.DayZCommander.Ui" 
		Title="MainWindow" 
		Height="650" 
		Width="970"
		AllowsTransparency="True" 
		Background="Transparent" 
		WindowStyle="None"
		ResizeMode="CanResizeWithGrip"
		MouseLeftButtonDown="MainWindow_OnMouseLeftButtonDown"
		>
	<Border Background="#222222"
			BorderBrush="#BBBBBB"
			BorderThickness="1">
		<Grid>
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto" />
				<RowDefinition Height="Auto" />
				<RowDefinition Height="Auto" />
				<RowDefinition />
			</Grid.RowDefinitions>
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="180"/>
				<ColumnDefinition/>
			</Grid.ColumnDefinitions>


			<Rectangle Fill="#444444"
					   Grid.Row="1"
					   Grid.RowSpan="4"
					   Grid.ColumnSpan="2"/>

			<Grid Grid.ColumnSpan="2">
				<Grid.ColumnDefinitions>
					<ColumnDefinition/>
					<ColumnDefinition Width="Auto"/>
				</Grid.ColumnDefinitions>

				<StackPanel>
					<TextBlock Text="{Binding CurrentVersion, FallbackValue=Unknown}"
					           FontSize="10"
					           Width="245"
					           TextAlignment="Right"
					           HorizontalAlignment="Left"
					           Margin="30 4 0 -8"
					           Foreground="#777"/>
					<TextBlock Text="DayZ Commander"
						   Foreground="#EEEEEE"
						   FontSize="28"
						Grid.Column="0"
						   HorizontalAlignment="Left"
							IsHitTestVisible="False"
						   Margin="30 -6 0 7"/>
				</StackPanel>
				<StackPanel Grid.Column="1" 
						HorizontalAlignment="Right">
					<Button Tag="X" 
						Margin="0 8 10 0"
						Foreground="#EEE"
						FontSize="14"
						FontFamily="Verdana"
						Template="{StaticResource MetroTextButton}" Click="CloseButton_Click" />
				</StackPanel>
			</Grid>

			<StackPanel Grid.Row="1" 
						Grid.RowSpan="3" 
						Margin="30 8 0 0"
						Grid.Column="0">
				<TextBlock Text="filter" 
						   FontSize="22" 
						   Foreground="#5A97F2"
						   Margin="0 0 0 4"/>
				<Ui:Filters 
					Margin="0 0 8 0"
					VerticalAlignment="Stretch"
					HorizontalAlignment="Stretch"/>

				<Ui:FriendsList
					Margin="0 0 8 0"
					VerticalAlignment="Stretch"
					HorizontalAlignment="Stretch"/>
			</StackPanel>

			<StackPanel
						Grid.Column="1"
					   Margin="36 8 20 0"
					   Grid.Row="1">		
				<StackPanel Orientation="Horizontal">

					<TextBlock Text="servers " Foreground="#EEE" Margin="0 0 0 0" FontSize="22"/>
					<TextBlock Text="(" FontSize="15" Foreground="#EEE" Margin="0 7 0 0"/>
					<TextBlock Text="{Binding ProcessedServersCount, StringFormat={}{0}/, FallbackValue=0}" 
							   Visibility="{Binding UnprocessedServersCount, Converter={StaticResource NonZeroToVisibilityConverter}}"
							   Foreground="#AAA"
							   Margin="0 7 0 0"
							   FontSize="15"/>
					<TextBlock Text="{Binding TotalServerCount, StringFormat={}{0}), FallbackValue=0}"
						   FontSize="15"
							   Margin="0 7 0 0"
							  Foreground="#EEE"/>

					<Button Template="{StaticResource MetroButton}"
							Click="RefreshAll_Click"
							Visibility="{Binding UnprocessedServersCount, Converter={StaticResource ZeroToVisibilityConverter}}"
							Margin="20 6 0 0">
						<Button.Content>
							<StackPanel Orientation="Horizontal">
								<Image Source="..\Assets\Images\refresh.png" 
								   Height="24"
								   Width="24"/>
								<TextBlock Text="refresh"
										   VerticalAlignment="Center"
										   Foreground="#FFF"/>
							</StackPanel>
						</Button.Content>
					</Button>
				</StackPanel>
				<ProgressBar 
							 HorizontalAlignment="Stretch" 
							 BorderThickness="0" 
							 Height="3" 
							 Background="Transparent" 
							 Visibility="{Binding UnprocessedServersCount, Converter={StaticResource NonZeroToVisibilityConverter}}"
							 Maximum="{Binding TotalServerCount, FallbackValue=0}" 
							 Value="{Binding ProcessedServersCount, FallbackValue=0}" />
			</StackPanel>

			<Grid Margin="26 3 20 20"
				  Grid.Column="1"
				  Grid.Row="3">
				<Grid.RowDefinitions>
					<RowDefinition Height="55*"/>
					<RowDefinition Height="45*"/>
				</Grid.RowDefinitions>
				
				<DataGrid ItemsSource="{Binding Servers}"
						  Margin="8 0 0 0"
					  VerticalScrollBarVisibility="Visible"
					  Background="Transparent"
					 HeadersVisibility="Column"
					  Foreground="#DDD"
					  RowBackground="Transparent"
					  BorderThickness="0"
					  SelectedItem="{Binding SelectedServer, Mode=TwoWay}"
					ColumnHeaderStyle="{StaticResource MetroDataGridHeader}"						  
					  AutoGenerateColumns="False">
					<DataGrid.Resources>
						<Style TargetType="{x:Type DataGridCell}">
							<Setter Property="Template">
								<Setter.Value>
									<ControlTemplate TargetType="{x:Type DataGridCell}">
										<Border Padding="0 2 8 2">
											<ContentPresenter />
										</Border>
									</ControlTemplate>
								</Setter.Value>
							</Setter>
						</Style>
					</DataGrid.Resources>
					<DataGrid.Columns>
						<DataGridTextColumn Binding="{Binding Name, Mode=OneWay}" 
											HeaderStyle="{StaticResource MetroDataGridHeader}"
											Header="NAME"	
											Width="*" >
						</DataGridTextColumn>
						<DataGridTemplateColumn 
											HeaderStyle="{StaticResource MetroDataGridHeader}"
											Header="DIFFICULTY"	
											SortMemberPath="Difficulty"
											Width="75" >
							<DataGridTemplateColumn.CellTemplate>
								<DataTemplate>
									<TextBlock Text="{Binding Difficulty, Converter={StaticResource DifficultyToDescriptionConverter}, ConverterParameter=''}"
										   FontSize="10"
										   FontWeight="Bold"
											Foreground="#CCC"
											   Margin="3 0 0 0"
										   VerticalAlignment="Center"/>
								</DataTemplate>
							</DataGridTemplateColumn.CellTemplate>							
						</DataGridTemplateColumn>
						<DataGridTemplateColumn Width="60" 
												Header="TIME" 
												SortMemberPath="ServerTime" 
												HeaderStyle="{StaticResource MetroDataGridHeaderRight}">
							<DataGridTemplateColumn.CellTemplate>
								<DataTemplate>
									<TextBlock Text="{Binding ServerTime, StringFormat={}{0:h:mm tt}}"
										   TextAlignment="Right"
										   FontSize="10"
										   FontWeight="Bold"
										   HorizontalAlignment="Right"
										   VerticalAlignment="Center"
										Foreground="{Binding ServerTime, Converter={StaticResource TimeToColorConverter}}"/>
								</DataTemplate>
							</DataGridTemplateColumn.CellTemplate>
						</DataGridTemplateColumn>
						<DataGridTemplateColumn Width="60" Header="PLAYERS" SortMemberPath="CurrentPlayers" HeaderStyle="{StaticResource MetroDataGridHeaderRight}">
							<DataGridTemplateColumn.CellTemplate>
								<DataTemplate>
									<StackPanel Orientation="Horizontal" 
											VerticalAlignment="Center"
											HorizontalAlignment="Right">
										<TextBlock Text="{Binding CurrentPlayers}" Foreground="{Binding Converter={StaticResource ServerFullnessToColorConverter}}"/>
										<TextBlock Text="/"/>
										<TextBlock Text="{Binding MaxPlayers}" Foreground="{Binding Converter={StaticResource ServerFullnessToColorConverter}}"/>
									</StackPanel>
								</DataTemplate>
							</DataGridTemplateColumn.CellTemplate>
						</DataGridTemplateColumn>
						<DataGridTemplateColumn Width="60" Header="PING" SortMemberPath="Ping" HeaderStyle="{StaticResource MetroDataGridHeaderRight}">
							<DataGridTemplateColumn.CellTemplate>
								<DataTemplate>
									<Grid>
										<ProgressBar Value="{Binding Ping}" 
												 Maximum="400" 
												 Width="50" 
												 Height="20" 
												 IsIndeterminate="False" 
												 Foreground="{Binding Ping, Converter={StaticResource PingToForegroundConverter}}" 
												 Background="Transparent"/>
										<TextBlock Text="{Binding Ping, StringFormat={}{0}ms}" 
											   Foreground="{Binding Ping, Converter={StaticResource PingToForegroundConverter}}"  
											   FontSize="10" 
											   Padding="0 4 4 0"
											   Width="50" 
											   Height="20" 
											   VerticalAlignment="Center" 
											   TextAlignment="Right"/>
									</Grid>
								</DataTemplate>
							</DataGridTemplateColumn.CellTemplate>
						</DataGridTemplateColumn>
					</DataGrid.Columns>
				</DataGrid>
				
				<Grid DataContext="{Binding SelectedServer}" 
					  Visibility="{Binding Converter={StaticResource NotNullToVisibilityConverter}}"
					  Margin="0 20 0 0"
					  Background="#333333"
					  Grid.Row="1">
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto"/>	
						<RowDefinition/>	
					</Grid.RowDefinitions>

					<StackPanel 
						Orientation="Horizontal"
						Margin="25 10 25 4">
						<TextBlock Text="{Binding Name}" 
								   Margin="0 0 10 0"
							   FontSize="18"
							   Foreground="#EEEEEE"/>
					</StackPanel>
					<StackPanel
						Margin="25 10 0 0"
						Orientation="Horizontal"
						Grid.Row="1">
						
						<StackPanel>
							<Button Content="Join" 
								FontWeight="Bold"
								Width="100"
								Background="#96F896" 
								FontSize="20" 
								Padding="8 2" 
								Grid.ColumnSpan="2"
								Click="JoinServer"
								VerticalAlignment="Top"/>

							<Button Content="Refresh" 
								Background="#7DCF7D" 
								FontSize="12" 
								Padding="8 2" 
								Margin="0 5"
								Width="100"
								Grid.Row="1"
								Grid.ColumnSpan="2"
								Click="RefreshServer"
								VerticalAlignment="Top"/>
						</StackPanel>
						
						<Grid HorizontalAlignment="Left"
							  Margin="24 0 0 0">
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="Auto"/>
								<ColumnDefinition />
							</Grid.ColumnDefinitions>
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto"/>
								<RowDefinition Height="Auto"/>
								<RowDefinition Height="Auto"/>
							</Grid.RowDefinitions>

							<Grid Grid.Row="0"
								  Grid.ColumnSpan="2"
								  Margin="0 0 0 6">
								<ProgressBar Value="{Binding Ping}" 
												 Maximum="400" 
												 Width="100" 
												 Height="24" 
												 IsIndeterminate="False" 
												 Foreground="{Binding Ping, Converter={StaticResource PingToForegroundConverter}}" 
												 Background="Transparent"/>
								<TextBlock Text="{Binding Ping, StringFormat={}{0}ms}" 
											   Foreground="{Binding Ping, Converter={StaticResource PingToForegroundConverter}}"  
											   FontWeight="Bold" 
											   Padding="0 4 4 0"
											   Width="100" 
											   Height="20" 
											   VerticalAlignment="Center" 
											   TextAlignment="Right"/>
							</Grid>

							<TextBlock Text="Players"
									   Margin="0 0 4 6"
									   Grid.Row="1"
									   Foreground="#CCC"/>
							<StackPanel Orientation="Horizontal" 
										Margin="0 0 0 6"
										Grid.Column="1"
										Grid.Row="1"
											HorizontalAlignment="Right">
								<TextBlock Text="{Binding CurrentPlayers}"
										   FontWeight="Bold" 
										   Foreground="{Binding Converter={StaticResource ServerFullnessToColorConverter}}"/>
								<TextBlock Text="/"
										   FontWeight="Bold" 
										   Foreground="#EEE"/>
								<TextBlock Text="{Binding MaxPlayers}"
										   FontWeight="Bold" 
										   Foreground="{Binding Converter={StaticResource ServerFullnessToColorConverter}}"/>
							</StackPanel>

							<TextBlock Text="Time"
									   Margin="0 0 4 6"
									   Grid.Row="2"
									   Foreground="#CCC"/>
							<TextBlock Text="{Binding ServerTime, StringFormat={}{0:h:mm tt}}"
										   TextAlignment="Right"
											Margin="0 0 0 6"
											Grid.Row="2"
											Grid.Column="1"
										   FontWeight="Bold"
										   HorizontalAlignment="Right"
										   VerticalAlignment="Center"
										Foreground="{Binding ServerTime, Converter={StaticResource TimeToColorConverter}}"/>

						</Grid>

						<DataGrid ItemsSource="{Binding Players}"
								  x:Name="PlayersList"
								  Background="Transparent"
								  SelectionChanged="OnPlayerSelectionChanged"
								  HeadersVisibility="Column"
								  BorderThickness="0"
								  Grid.Column="1"
								  Margin="24 0 0 10"
								  HorizontalAlignment="Right"
								  RowBackground="Transparent"
								  VerticalScrollBarVisibility="Auto"
								  Foreground="#EEEEEE"
								  ColumnHeaderStyle="{StaticResource MetroDataGridHeader}"
								  AutoGenerateColumns="False">
							<DataGrid.Resources>
								<Style TargetType="{x:Type DataGridCell}">
									<Setter Property="IsHitTestVisible" Value="False"/>
								</Style>
							</DataGrid.Resources>
							
							<DataGrid.Columns>
								<DataGridTextColumn Binding="{Binding Name}" Header="NAME" HeaderStyle="{StaticResource MetroDataGridHeader}" />
								<DataGridTextColumn Binding="{Binding Score}" Header="SCORE" HeaderStyle="{StaticResource MetroDataGridHeader}"/>
								<DataGridTextColumn Binding="{Binding Deaths}" Header="DEATHS" HeaderStyle="{StaticResource MetroDataGridHeader}"/>
							</DataGrid.Columns>

						</DataGrid>
					</StackPanel>
				</Grid>
			</Grid>
		
		</Grid>

	</Border>
</Window>
